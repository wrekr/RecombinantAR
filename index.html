<meta aframe-injected="" name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,shrink-to-fit=no,user-scalable=no,minimal-ui">
<meta aframe-injected="" name="mobile-web-app-capable" content="yes">
<head>
<style>
	@import url('https://fonts.googleapis.com/css?family=Roboto:300,500,900')

body
	margin 0px
	overflow hidden
	font-family 'Roboto', sans-serif

.btns-wrap
	font-family 'Roboto', sans-serif
	bottom 20px
	left 20px
	position absolute
	display flex
	flex-direction row
	z-index 9998
	
.btn
	user-select none
	cursor pointer
	box-sizing border-box
	margin 18px
	border-radius 1000px
	width 60px
	height 60px
	background #f45
	display inline-block
	text-align center
	padding 17px 20px
	transition all 0.2s
	
.rotate
	background-color #0078ff
	background-image url(https://storage.googleapis.com/material-icons/external-assets/v4/icons/svg/ic_3d_rotation_white_24px.svg)
	background-size 60%
	background-repeat no-repeat
	background-position center
	&_fade
		opacity 0.4
		background-color #323965
	
.scale
	background-color #f02853
	background-image url(https://storage.googleapis.com/material-icons/external-assets/v4/icons/svg/ic_zoom_in_white_24px.svg)
	</style>
</head>
<script src="https://aframe.io/releases/0.7.0/aframe.min.js"></script>
<script src="https://cdn.rawgit.com/jeromeetienne/AR.js/1.5.0/aframe/build/aframe-ar.js"></script>

<div class="AR-tip">
	<p>This is a AR-pen. To see 3d models use <a style="white-space: nowrap" class="links" target="_blank" href="https://www.google.ru/search?q=hiro+marker&newwindow=1&source=lnms&tbm=isch&sa=X&ved=0ahUKEwiV97CF6LnXAhUHpqQKHSfEBSAQ_AUICigB&biw=1676&bih=855&dpr=2">Hiro-marker</a></p>
	<a class="gotit" href="#">Got it!</a>
</div>

<div class="btns-wrap">
	<div class="btn rotate"></div>
	<div class="btn scale"></div>
	<div class="btn switch">Kyiv</div>
</div>

<a-scene embedded arjs='trackingMethod: best; sourceType: webcam; debugUIEnabled: false;'>

	<a-assets>
		<a-asset-item id="london-obj" src="https://raw.githubusercontent.com/PavelLaptev/test-rep/master/AR-Framer-meetup/3d-models/london/framer-model-renew.obj"></a-asset-item>
		<a-asset-item id="london-mtl" src="https://raw.githubusercontent.com/PavelLaptev/test-rep/master/AR-Framer-meetup/3d-models/london/framer-model-renew.mtl"></a-asset-item>
		<a-asset-item id="kyiv-obj" src="https://raw.githubusercontent.com/PavelLaptev/test-rep/master/AR-Framer-meetup/3d-models/kyiv/kyiv-framer-model.obj"></a-asset-item>
		<a-asset-item id="kyiv-mtl" src="https://raw.githubusercontent.com/PavelLaptev/test-rep/master/AR-Framer-meetup/3d-models/kyiv/kyiv-framer-model.mtl"></a-asset-item>
	</a-assets>

	<a-marker preset="hiro" id="aframe-scene">

		<a-entity light="type: hemisphere; color: #fefddd; groundColor: #fefddd; intensity: 1.2"></a-entity>

		<a-entity id="london" rotation="0 -90 0" side="double" position="0.0 0.2 0" scale="0.4 0.4 0.4" obj-model="obj: #london-obj; mtl: #london-mtl">
			<a-animation attribute="rotation" begin="rotate" end="endRotate" dur="26000" fill="forwards" to="0 270 0" repeat="indefinite" easing="linear">
			</a-animation>
		</a-entity>

		<a-entity id="kyiv" visible="false" rotation="0 -90 0" side="double" position="0.0 0.2 0" scale="0.4 0.4 0.4" obj-model="obj: #kyiv-obj; mtl: #kyiv-mtl">
			<a-animation attribute="rotation" begin="rotate" end="endRotate" dur="26000" fill="forwards" to="0 270 0" repeat="indefinite" easing="linear">
			</a-animation>
		</a-entity>

	</a-marker>

	<a-entity camera></a-entity>

</a-scene>

<script>console.clear()

var londonModel = document.querySelector('#london'),
		kyivModel = document.querySelector('#kyiv'),
		rotateBtn = $(".rotate"),
		scaleBtn = $(".scale"),
		switchBtn = $(".switch"),
		gotitBtn = $(".gotit"); 


gotitBtn.click(function(){
	gotitBtn.parent().css({
		display: "none"
	});
});


rotateBtn.click(function(){
	if (rotateBtn.hasClass("rotate_fade")){
		londonModel.emit('endRotate');
		kyivModel.emit('endRotate');
		rotateBtn.removeClass("rotate_fade");
	} else {
		londonModel.emit('rotate');
		kyivModel.emit('rotate');
		rotateBtn.addClass("rotate_fade");
	}
});

var scaleFlag = 0,
		kyivFlag = false;

scaleBtn.click(function(){
	if (scaleFlag == 0){
		scaleFlag = 1;
		londonModel.setAttribute("scale", scale="0.55 0.55 0.55");
		kyivModel.setAttribute("scale", scale="0.55 0.55 0.55");
		scaleBtn.addClass("scale_one");
	} else if (scaleFlag == 1) {
		scaleFlag = 2;
		londonModel.setAttribute("scale", scale="0.7 0.7 0.7");
		kyivModel.setAttribute("scale", scale="0.7 0.7 0.7");
		scaleBtn.addClass("scale_two");
		scaleBtn.removeClass("scale_one");
	} else if (scaleFlag == 2) {
		scaleFlag = 0;
		londonModel.setAttribute("scale", scale="0.4 0.4 0.4");
		kyivModel.setAttribute("scale", scale="0.4 0.4 0.4");
		scaleBtn.removeClass("scale_two");
	}
});

switchBtn.click(function(){
	if (kyivFlag == false){
		kyivFlag = true;
		switchBtn.html("London");
		londonModel.setAttribute("visible", false);
		kyivModel.setAttribute("visible", true);
	} else {
		kyivFlag = false
		switchBtn.html("Kyiv");
		londonModel.setAttribute("visible", true);
		kyivModel.setAttribute("visible", false);
	}
});</script>
